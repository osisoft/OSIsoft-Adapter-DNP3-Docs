<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Egress endpoints </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Egress endpoints ">
    <meta name="generator" content="docfx 2.56.5.0">
    
    <link rel="shortcut icon" href="../../../../favicon.ico">
    <link rel="stylesheet" href="../../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../../styles/main.css">
    <meta property="docfx:navrel" content="../../../../toc.html">
    <meta property="docfx:tocrel" content="../../../toc.html">
    
    <meta property="docfx:rel" content="../../../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="../../../../content/index.html" width="46">
                <img id="logo" src="../../../../content/main/shared-content/images/atlas_icon.png" height="46" width="46" alt="OSIsoft Edge System"> 
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="EgressEndpointsConfiguration">
<h1 id="egress-endpoints">Egress endpoints</h1>

<p>PI adapters collect time series data, which  they can send to a permanent data store (endpoint). This operation is called data egress. The following endpoints are available for data egress:</p>
<ul>
<li>OSIsoft Cloud Services (OCS)</li>
<li>PI servers through PI Web API</li>
<li>Edge Data Store (EDS)</li>
</ul>
<p>For long term storage and analysis, you can configure any adapter to send time series data to one or several of these endpoints in any combination. An egress endpoint is comprised of the properties specified under <a href="#egress-endpoint-parameters">Egress endpoint parameters</a>.</p>
<p>Data egress to a PI server creates a PI point in the PI adapter configuration. Data egress to OCS or EDS creates a stream in the PI adapter configuration.</p>
<p><strong>Note:</strong> Egress to EDS requires the adapter to be on the same server as EDS.</p>
<p>The name of the PI point or OCS or EDS stream is a combination of the StreamIdPrefix specified in the adapter data source configuration and the StreamId specified in the adapter data selection configuration.</p>
<h2 id="configure-egress-endpoints">Configure egress endpoints</h2>
<p>Complete the following steps to configure egress endpoints. Use the <code>PUT</code> method in conjunction with the <code>http://localhost:5590/api/v1/configuration/OmfEgress/dataendpoints</code> REST endpoint to initialize the configuration.</p>
<ol>
<li><p>Using a text editor, create an empty text file.</p>
</li>
<li><p>Copy and paste an example configuration for egress endpoints into the file.</p>
<p> For sample JSON, see <a href="#examples">Examples</a>.</p>
</li>
<li><p>Update the example JSON parameters for your environment.</p>
<p> For a table of all available parameters, see <a href="#egress-endpoint-parameters">Egress endpoint parameters</a>.</p>
</li>
<li><p>Save the file. For example, as <code>ConfigureEgressEndpoints.json</code>.</p>
</li>
<li><p>Open a command line session. Change directory to the location of <code>ConfigureEgressEndpoints.json</code>.</p>
</li>
<li><p>Enter the following cURL command (which uses the <code>PUT</code> method) to initialize the egress endpoints configuration.</p>
<pre><code class="lang-bash">curl -d &quot;@ConfigureEgressEndpoints.json&quot; -H &quot;Content-Type: application/json&quot; -X PUT &quot;http://localhost:5590/api/v1/configuration/OmfEgress/dataendpoints&quot;
</code></pre><p> <strong>Notes:</strong></p>
<ul>
<li>If you installed the adapter to listen on a non-default port, update <code>5590</code> to the port number in use.</li>
<li>For a list of other REST operations you can perform, like updating or replacing an egress endpoints configuration, see <a href="#rest-urls">REST URLs</a>.
<br>
<br></li>
</ul>
</li>
</ol>
<h2 id="egress-endpoint-configuration-schema">Egress endpoint configuration schema</h2>
<p>The full schema definition for the egress endpoint configuration is in the <code>OmfEgress_DataEndpoints_schema.json</code>  file located in one of the following folders:</p>
<p>Windows: <code>%ProgramFiles%\OSIsoft\Adapters\&lt;AdapterName&gt;\Schemas</code></p>
<p>Linux: <code>/opt/OSIsoft/Adapters/&lt;AdapterName&gt;/Schemas</code></p>
<h2 id="egress-endpoint-parameters">Egress endpoint parameters</h2>
<p>The following parameters are available for configuring egress endpoints:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Id</strong></td>
<td>Optional</td>
<td><code>string</code></td>
<td>Unique identifier<br><br>Allowed value: any string identifier<br>Default value: new GUID</td>
</tr>
<tr>
<td><strong>Endpoint</strong></td>
<td>Required</td>
<td><code>string</code></td>
<td>Destination that accepts OMF v1.1 messages. Supported destinations include OCS, PI Server, and EDS.<br><br>Allowed value: well-formed http or https endpoint string<br>Default: <code>null</code></td>
</tr>
<tr>
<td><strong>Username</strong></td>
<td>Required for PI server and EDS endpoint</td>
<td><code>string</code></td>
<td>Basic authentication to the PI Web API OMF or EDS endpoint <br><br><em>PI server:</em><br>Allowed value: any string<br>Default: <code>null</code><br><strong>Note:</strong> If your username contains a backslash, you must add an escape character, for example, type <code>OilCompany\TestUser</code> as <code>OilCompany\\TestUser</code>.<br><br><em>EDS:</em><br>Allowed value: any string, but cannot be <code>null</code>.</td>
</tr>
<tr>
<td><strong>Password</strong></td>
<td>Required for PI server and EDS endpoint</td>
<td><code>string</code></td>
<td>Basic authentication to the PI Web API OMF or EDS endpoint <br><br><em>PI server:</em><br>Allowed value: any string<br>Default: <code>null</code><br><br><em>EDS:</em><br>Allowed value: any string, but cannot be <code>null</code></td>
</tr>
<tr>
<td><strong>ClientId</strong></td>
<td>Required for OCS endpoint</td>
<td><code>string</code></td>
<td>Authentication with the OCS OMF endpoint <br><br>Allowed value: any string<br>Default: <code>null</code></td>
</tr>
<tr>
<td><strong>ClientSecret</strong></td>
<td>Required for OCS endpoint</td>
<td><code>string</code></td>
<td>Authentication with the OCS OMF endpoint <br><br>Allowed value: any string<br>Default: <code>null</code></td>
</tr>
<tr>
<td><strong>TokenEndpoint</strong></td>
<td>Optional for OCS endpoint</td>
<td><code>string</code></td>
<td>Retrieves an OCS token from an alternative endpoint <br><br>Allowed value: well-formed http or https endpoint string <br>Default value: <code>null</code></td>
</tr>
<tr>
<td><strong>ValidateEndpointCertificate</strong></td>
<td>Optional</td>
<td><code>boolean</code></td>
<td>Disables verification of destination certificate. <strong>Note:</strong> Only use for testing with self-signed certificates. <br><br>Allowed value: <code>true</code> or <code>false</code><br>Default value: <code>true</code></td>
</tr>
</tbody>
</table>
<h2 id="examples">Examples</h2>
<p>The following examples are valid egress configurations:</p>
<h3 id="egress-data-to-ocs">Egress data to OCS</h3>
<pre><code class="lang-json">[{
     &quot;Id&quot;: &quot;OCS&quot;,
     &quot;Endpoint&quot;: &quot;https://&lt;OCS OMF endpoint&gt;&quot;,
     &quot;ClientId&quot;: &quot;&lt;clientid&gt;&quot;,
     &quot;ClientSecret&quot;: &quot;&lt;clientsecret&gt;&quot;
}]
</code></pre><h3 id="egress-data-to-pi-web-api">Egress data to PI Web API</h3>
<pre><code class="lang-json">[{
     &quot;Id&quot;: &quot;PI Web API&quot;,
     &quot;Endpoint&quot;: &quot;https://&lt;pi web api server&gt;:&lt;port&gt;/piwebapi/omf/&quot;,
     &quot;UserName&quot;: &quot;&lt;username&gt;&quot;,
     &quot;Password&quot;: &quot;&lt;password&gt;&quot;
}]
</code></pre><h3 id="egress-data-to-eds">Egress data to EDS</h3>
<pre><code class="lang-json">[{
     &quot;Id&quot;: &quot;EDS&quot;,
     &quot;Endpoint&quot;: &quot;http://localhost:&lt;port&gt;/api/v1/tenants/default/namespaces/default/omf&quot;,
     &quot;UserName&quot;: &quot;eds&quot;,
     &quot;Password&quot;: &quot;eds&quot;
}]
</code></pre><h2 id="rest-urls">REST URLs</h2>
<table>
<thead>
<tr>
<th>Relative URL</th>
<th>HTTP verb</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr>
<td>api/v1/configuration/omfegress/DataEndpoints</td>
<td>GET</td>
<td>Gets all configured egress endpoints</td>
</tr>
<tr>
<td>api/v1/configuration/omfegress/DataEndpoints</td>
<td>DELETE</td>
<td>Deletes all configured egress endpoints</td>
</tr>
<tr>
<td>api/v1/configuration/omfegress/DataEndpoints</td>
<td>POST</td>
<td>Adds an array of egress endpoints or a single endpoint. Fails if any endpoint already exists</td>
</tr>
<tr>
<td>api/v1/configuration/omfegress/DataEndpoints</td>
<td>PUT</td>
<td>Replaces all egress endpoints</td>
</tr>
<tr>
<td>api/v1/configuration/omfegress/DataEndpoints</td>
<td>PATCH</td>
<td>Allows partial updating of configured endpoints.<br><strong>Note:</strong> The request must be an array containing one or more endpoints. Each endpoint in the array must include its <em>Id</em>.</td>
</tr>
<tr>
<td>api/v1/configuration/omfegress/DataEndpoints/{Id}</td>
<td>GET</td>
<td>Gets configured endpoint by <em>Id</em></td>
</tr>
<tr>
<td>api/v1/configuration/omfegress/DataEndpoints/{Id}</td>
<td>DELETE</td>
<td>Deletes configured endpoint by <em>Id</em></td>
</tr>
<tr>
<td>api/v1/configuration/omfegress/DataEndpoints/{Id}</td>
<td>PUT</td>
<td>Updates or creates a new endpoint with the specified <em>Id</em></td>
</tr>
<tr>
<td>api/v1/configuration/omfegress/DataEndpoints/{Id}</td>
<td>PATCH</td>
<td>Allows partial updating of configured endpoint by <em>Id</em></td>
</tr>
</tbody>
</table>
<h2 id="egress-execution-details">Egress execution details</h2>
<ul>
<li>After configuring an egress endpoint, egress is immediately run for that endpoint. Egress is handled individually per configured endpoint. When data is egressed for the first time, types and containers are egressed to the configured endpoint. After that only new or changed types or containers are egressed. Type creation must be successful in order to create containers. Container creation must be successful in order to egress data.</li>
<li>If you delete an egress endpoint, data flow immediately stops for that endpoint. Buffered data in a deleted endpoint is permanently lost.</li>
<li>Type, container, and data items are batched into one or more OMF messages when egressing. As per the requirements defined in OMF, a single message payload will not exceed 192KB in size. Compression is automatically applied to outbound egress messages. On the egress destination, failure to add a single item results in the message failing. Types, containers, and data are egressed as long as the destination continues to respond to HTTP requests.</li>
</ul>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/osisoft/PI-Adapter/blob/main/shared-content/configuration/egress-endpoints.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span><a href="https://www.osisoft.com/copyright/">© 2019 - 2021 OSIsoft, LLC. All rights reserved.</a></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../../styles/main.js"></script>
  </body>
</html>
